<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>JVM | 哑舍</title><meta name="description" content="JVM"><meta name="keywords" content="Java面试笔试,JVM"><meta name="author" content="Machine"><meta name="copyright" content="Machine"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/cat2.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="JVM"><meta name="twitter:description" content="JVM"><meta name="twitter:image" content="https://machine4869.gitee.io/img/default_p11.jpeg"><meta property="og:type" content="article"><meta property="og:title" content="JVM"><meta property="og:url" content="https://machine4869.gitee.io/2020/02/15/20200215102406916/"><meta property="og:site_name" content="哑舍"><meta property="og:description" content="JVM"><meta property="og:image" content="https://machine4869.gitee.io/img/default_p11.jpeg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="https://machine4869.gitee.io/2020/02/15/20200215102406916/"><link rel="prev" title="Java面试之JUC" href="https://machine4869.gitee.io/2020/02/21/20200221192831555/"><link rel="next" title="SparkCore" href="https://machine4869.gitee.io/2020/02/13/20200213103244757/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://machine4869.gitee.io/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"title":"Snackbar.bookmark.title","message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">哑舍</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 更多</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 豆瓣电影</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fa fa-picture-o"></i><span> 照片墙</span></a></li></ul></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/head.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">134</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">27</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">45</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 更多</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 豆瓣电影</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fa fa-picture-o"></i><span> 照片墙</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#JVM体系结构"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">JVM体系结构</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#JVM类型"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">JVM类型</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#JVM架构图"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">JVM架构图</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#类装载器ClassLoader"><span class="toc_mobile_items-number">1.3.</span> <span class="toc_mobile_items-text">类装载器ClassLoader</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#ClassLoader类型"><span class="toc_mobile_items-number">1.3.1.</span> <span class="toc_mobile_items-text">ClassLoader类型</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#双亲委派机制-沙箱安全机制"><span class="toc_mobile_items-number">1.3.2.</span> <span class="toc_mobile_items-text">双亲委派机制 沙箱安全机制</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Execution-Engine执行引擎"><span class="toc_mobile_items-number">1.4.</span> <span class="toc_mobile_items-text">Execution Engine执行引擎</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Native-Method-Stack-amp-Native-Interface-amp-native-libraies"><span class="toc_mobile_items-number">1.5.</span> <span class="toc_mobile_items-text">Native Method Stack &amp; Native Interface &amp; native libraies</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#PC寄存器"><span class="toc_mobile_items-number">1.6.</span> <span class="toc_mobile_items-text">PC寄存器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Method-Area-方法区"><span class="toc_mobile_items-number">1.7.</span> <span class="toc_mobile_items-text">Method Area 方法区</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Stack栈"><span class="toc_mobile_items-number">1.8.</span> <span class="toc_mobile_items-text">Stack栈</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#栈-堆-方法区的交互关系"><span class="toc_mobile_items-number">1.9.</span> <span class="toc_mobile_items-text">栈+堆+方法区的交互关系</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#堆体系结构"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">堆体系结构</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#堆结构简介"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">堆结构简介</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#字符串常量池"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text">字符串常量池</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#堆的new对象流程"><span class="toc_mobile_items-number">2.3.</span> <span class="toc_mobile_items-text">堆的new对象流程</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#堆参数调优"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">堆参数调优</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#面试"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">面试</span></a></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#JVM体系结构"><span class="toc-number">1.</span> <span class="toc-text">JVM体系结构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#JVM类型"><span class="toc-number">1.1.</span> <span class="toc-text">JVM类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JVM架构图"><span class="toc-number">1.2.</span> <span class="toc-text">JVM架构图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#类装载器ClassLoader"><span class="toc-number">1.3.</span> <span class="toc-text">类装载器ClassLoader</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ClassLoader类型"><span class="toc-number">1.3.1.</span> <span class="toc-text">ClassLoader类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#双亲委派机制-沙箱安全机制"><span class="toc-number">1.3.2.</span> <span class="toc-text">双亲委派机制 沙箱安全机制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Execution-Engine执行引擎"><span class="toc-number">1.4.</span> <span class="toc-text">Execution Engine执行引擎</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Native-Method-Stack-amp-Native-Interface-amp-native-libraies"><span class="toc-number">1.5.</span> <span class="toc-text">Native Method Stack &amp; Native Interface &amp; native libraies</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PC寄存器"><span class="toc-number">1.6.</span> <span class="toc-text">PC寄存器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Method-Area-方法区"><span class="toc-number">1.7.</span> <span class="toc-text">Method Area 方法区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stack栈"><span class="toc-number">1.8.</span> <span class="toc-text">Stack栈</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#栈-堆-方法区的交互关系"><span class="toc-number">1.9.</span> <span class="toc-text">栈+堆+方法区的交互关系</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#堆体系结构"><span class="toc-number">2.</span> <span class="toc-text">堆体系结构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#堆结构简介"><span class="toc-number">2.1.</span> <span class="toc-text">堆结构简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#字符串常量池"><span class="toc-number">2.2.</span> <span class="toc-text">字符串常量池</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#堆的new对象流程"><span class="toc-number">2.3.</span> <span class="toc-text">堆的new对象流程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#堆参数调优"><span class="toc-number">3.</span> <span class="toc-text">堆参数调优</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#面试"><span class="toc-number">4.</span> <span class="toc-text">面试</span></a></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(/img/default_p11.jpeg)"><div id="post-info"><div id="post-title"><div class="posttitle">JVM</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-02-15<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-02-23</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/JVM/">JVM</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon fa-fw" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">3k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon fa-fw" aria-hidden="true"></i><span>阅读时长: 10 分钟</span><div class="post-meta-pv-cv"><span class="post-meta__separator">|</span><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span><span class="post-meta__separator">|</span><i class="fa fa-comments-o post-meta__icon fa-fw" aria-hidden="true"></i><span>评论数:</span><a href="/2020/02/15/20200215102406916/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2020/02/15/20200215102406916/" itemprop="commentCount"></span></a></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><blockquote>
<p>参考：</p>
<ul>
<li><p><a href="http://www.atguigu.com" target="_blank" rel="noopener">www.atguigu.com</a></p>
</li>
<li><p><a href="https://www.bilibili.com/video/av70166821?p=13" target="_blank" rel="noopener">https://www.bilibili.com/video/av70166821?p=13</a></p>
</li>
</ul>
</blockquote>
<h1 id="JVM体系结构"><a href="#JVM体系结构" class="headerlink" title="JVM体系结构"></a>JVM体系结构</h1><h2 id="JVM类型"><a href="#JVM类型" class="headerlink" title="JVM类型"></a>JVM类型</h2><p>HotSpot</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sh</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; java -version</span><br><span class="line">java version <span class="string">"1.8.0_231"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_231-b11)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.231-b11, mixed mode)</span><br></pre></td></tr></table></figure></div>



<h2 id="JVM架构图"><a href="#JVM架构图" class="headerlink" title="JVM架构图"></a>JVM架构图</h2><a href="/2020/02/15/20200215102406916/image-20200215124708658.png" data-fancybox="group" data-caption="image-20200215124708658" class="fancybox"><img alt="image-20200215124708658" style="zoom:80%;" title="image-20200215124708658" data-src="/2020/02/15/20200215102406916/image-20200215124708658.png" class="lazyload"></a>

<p>灰色：线程私有，内存很小（kb），不存在垃圾回收（因为生命周期随线程生死）。</p>
<p>橘色：线程共享，存在垃圾回收，大部分垃圾回收都是收的堆。</p>
<h2 id="类装载器ClassLoader"><a href="#类装载器ClassLoader" class="headerlink" title="类装载器ClassLoader"></a>类装载器ClassLoader</h2><p>负责加载class文件，class文件在文件开头有<strong>特定的文件标示（cafe babe）</strong>，将class文件字节码内容加载到内存中，并将这些内容转换成方法区中的运行时数据结构并且ClassLoader只负责class文件的加载，至于它是否可以运行，则由Execution Engine决定</p>
<a href="/2020/02/15/20200215102406916/image-20200215112732617.png" data-fancybox="group" data-caption="image-20200215112732617" class="fancybox"><img alt="image-20200215112732617" style="zoom:80%;" title="image-20200215112732617" data-src="/2020/02/15/20200215102406916/image-20200215112732617.png" class="lazyload"></a>

<h3 id="ClassLoader类型"><a href="#ClassLoader类型" class="headerlink" title="ClassLoader类型"></a><strong>ClassLoader类型</strong></h3><ul>
<li>虚拟机自带的加载器<ul>
<li>启动类加载器（Bootstrap）C++</li>
<li>扩展类加载器（Extension）Java</li>
<li>应用程序类加载器（AppClassLoader）Java也叫系统类加载器，加载当前应用的classpath的所有类</li>
</ul>
</li>
<li>用户自定义加载器<ul>
<li>Java.lang.ClassLoader的子类，用户可以定制类的加载方式</li>
</ul>
</li>
</ul>
<a href="/2020/02/15/20200215102406916/image-20200215115409132.png" data-fancybox="group" data-caption="image-20200215115409132" class="fancybox"><img alt="image-20200215115409132" style="zoom:80%;" title="image-20200215115409132" data-src="/2020/02/15/20200215102406916/image-20200215115409132.png" class="lazyload"></a>

<p>这些加载器的使用场合？</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mxx.jvm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyObject</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 1. java自带的用Bootstrap</span></span><br><span class="line">        <span class="comment">// 因为根加载器（Bootstrap）一开始就加载了这些类</span></span><br><span class="line">        <span class="comment">// jre/lib/rt.jar包一启动就加载进了JVM里</span></span><br><span class="line">        Object object = <span class="keyword">new</span> Object();</span><br><span class="line">        System.out.println(object.getClass().getClassLoader()); <span class="comment">// null，因为Bootstrap是c++写的</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. 用户自己写的用AppClassLoader</span></span><br><span class="line">        <span class="comment">// sun.misc.Launcher就是JVM相关调用的入口程序</span></span><br><span class="line">        MyObject myObject = <span class="keyword">new</span> MyObject();</span><br><span class="line">        System.out.println(myObject.getClass().getClassLoader().getParent().getParent());<span class="comment">// null</span></span><br><span class="line">        System.out.println(myObject.getClass().getClassLoader().getParent());<span class="comment">// sun.misc.Launcher$ExtClassLoader@1b6d3586</span></span><br><span class="line">        System.out.println(myObject.getClass().getClassLoader()); <span class="comment">// sun.misc.Launcher$AppClassLoader@18b4aac2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. javax开头的包就是使用扩展类加载器（Extension）加载的</span></span><br><span class="line">        <span class="comment">// lib/ext/*里面的jar包会被装载</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4. 用户自定义，继承java.lang.ClassLoader</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<h3 id="双亲委派机制-沙箱安全机制"><a href="#双亲委派机制-沙箱安全机制" class="headerlink" title="双亲委派机制 沙箱安全机制"></a><strong>双亲委派机制 沙箱安全机制</strong></h3><p>双亲委派机制：</p>
<p>一个类是如何找加载器的？</p>
<p>当一个类收到了类加载请求，他首先不会尝试自己去加载这个类，而是把这个请求委派给父类去完成，每一个层次类加载器都是如此，因此所有的加载请求都应该传送到启动类加载其中，只有当父类加载器反馈自己无法完成这个请求的时候（在它的加载路径下没有找到所需加载的Class），子类加载器才会尝试自己去加载。</p>
<p>采用双亲委派的一个好处是比如加载位于 rt.jar 包中的类 java.lang.Object，不管是哪个加载器加载这个类，最终都是委托给顶层的启动类加载器进行加载，这样就保证了使用不同的类加载器最终得到的都是同样一个 Object对象。 </p>
<p>证明：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">String</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"hello"</span>);</span><br><span class="line">        <span class="comment">// 会报错：错误: 在类 java.lang.String 中找不到 main 方法</span></span><br><span class="line">        <span class="comment">// 因为先找的Bootstrap，结果直接找到了。所以用户自定义的这个类是无法被加载的。</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>即，你写的代码不能污染java源代码，</p>
<hr>
<p>沙箱安全机制：<br>沙箱安全机制是由基于双亲委派机制上 采取的一种JVM的自我保护机制,假设你要写一个java.lang.String 的类,由于双亲委派机制的原理,此请求会先交给Bootstrap试图进行加载,但是Bootstrap在加载类时首先通过包和类名查找rt.jar中有没有该类,有则优先加载rt.jar包中的类,因此就保证了java的运行机制不会被破坏.</p>
<h2 id="Execution-Engine执行引擎"><a href="#Execution-Engine执行引擎" class="headerlink" title="Execution Engine执行引擎"></a>Execution Engine执行引擎</h2><p>负责解释命令，提交操作系统执行。</p>
<h2 id="Native-Method-Stack-amp-Native-Interface-amp-native-libraies"><a href="#Native-Method-Stack-amp-Native-Interface-amp-native-libraies" class="headerlink" title="Native Method Stack &amp; Native Interface &amp; native libraies"></a>Native Method Stack &amp; Native Interface &amp; native libraies</h2><p>本地接口的作用是融合不同的编程语言为 Java 所用，它的初衷是融合 C/C++程序，Java 诞生的时候是 C/C++横行的时候，要想立足，必须有调用 C/C++程序，就在内存中专门开辟了一块区域处理标记为native的代码，它的具体做法是 Native Method Stack中登记 native方法，在Execution Engine 执行时加载native libraies。</p>
<p>目前该方法使用的越来越少了，除非是与硬件有关的应用，比如通过Java程序驱动打印机或者Java系统管理生产设备，<strong>在企业级应用中已经比较少见</strong>。因为现在的<strong>异构领域间的通信很发达</strong>（因此不用关心内部），比如可以使用 Socket通信，也可以使用Web Service等等</p>
<p>native方法举例</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Thread().start();</span><br><span class="line"><span class="comment">// 核心源码：</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">start0</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// 线程是系统级的，需要底层操作系统支持。而native申明的方法就是调用的本地方法库。</span></span><br><span class="line"><span class="comment">// 这个方法只有申明，实现是交给底层的。</span></span><br><span class="line"><span class="comment">// 如果是native方法，就放native栈里。</span></span><br></pre></td></tr></table></figure></div>



<h2 id="PC寄存器"><a href="#PC寄存器" class="headerlink" title="PC寄存器"></a>PC寄存器</h2><p>每个线程都有一个程序计数器，是线程私有的,就是一个指针，指向方法区中的方法字节码（<strong>用来存储指向下一条指令的地址,也即将要执行的指令代码</strong>），由执行引擎读取下一条指令，是一个非常小的内存空间，几乎可以忽略不记。</p>
<p>这块内存区域很小，它是<strong>当前线程所执行的字节码的行号指示器</strong>，字节码解释器通过改变这个计数器的值来选取下一条需要执行的字节码指令。</p>
<p>如果执行的是一个Native方法，那这个计数器是空的。</p>
<p>用以完成分支、循环、跳转、异常处理、线程恢复等基础功能。不会发生内存溢出(OutOfMemory=OOM)错误。（占用很小，只是记个行号）</p>
<h2 id="Method-Area-方法区"><a href="#Method-Area-方法区" class="headerlink" title="Method Area 方法区"></a>Method Area 方法区</h2><p>供各线程共享的运行时内存区域。<strong>它存储了每一个类的结构信息（Xxx.class–&gt;classLoader –&gt;Xxx Class，这个Xxx Class就存在方法区里）</strong>，例如<strong>运行时常量池（Runtime Constant Pool）</strong>、字段和方法数据、构造函数和普通方法的字节码内容。上面讲的是规范，在不同虚拟机里头实现是不一样的，最典型的就是永久代(PermGen space)和元空间(Metaspace)。</p>
<p>But</p>
<p>实例变量存在堆内存中,和方法区无关。</p>
<h2 id="Stack栈"><a href="#Stack栈" class="headerlink" title="Stack栈"></a>Stack栈</h2><p>栈管运行，堆管存储。</p>
<p>栈也叫栈内存，主管Java程序的运行，是在线程创建时创建，它的生命期是跟随线程的生命期，线程结束栈内存也就释放，<strong>对于栈来说不存在垃圾回收问题</strong>，只要线程一结束该栈就Over，生命周期和线程一致，是线程私有的。<strong>8种基本类型的变量+对象的引用变量+实例方法都是在函数的栈内存中分配</strong>。</p>
<p>函数栈内存：<br>基本类型：int，long，float<br>引用变量：User = new User();  等号左边叫引用变量<br>实例方法：user.eat()</p>
<p>Java方法 = 栈帧        （就是把方法压栈的意思）</p>
<a href="/2020/02/15/20200215102406916/image-20200215150006565.png" data-fancybox="group" data-caption="image-20200215150006565" class="fancybox"><img alt="image-20200215150006565" style="zoom:80%;" title="image-20200215150006565" data-src="/2020/02/15/20200215102406916/image-20200215150006565.png" class="lazyload"></a>

<p><strong>栈存储什么?</strong><br>栈帧中主要保存3 类数据：<br>本地变量（Local Variables）:输入参数和输出参数以及方法内的变量；<br>栈操作（Operand Stack）:记录出栈、入栈的操作；<br>栈帧数据（Frame Data）:包括类文件、方法等等。</p>
<p><strong>栈运行原理：</strong></p>
<p>栈中的数据都是以栈帧（Stack Frame）的格式存在，栈帧是一个内存区块，是一个数据集，是一个有关方法(Method)和运行期数据的数据集，<strong>当一个方法A被调用时就产生了一个栈帧 F1，并被压入到栈中</strong>。</p>
<p>A方法又调用了 B方法，于是产生栈帧 F2 也被压入栈，<br>B方法又调用了 C方法，于是产生栈帧 F3 也被压入栈，<br>……<br>执行完毕后，先弹出F3栈帧，再弹出F2栈帧，再弹出F1栈帧……<br>遵循“先进后出”/“后进先出”原则。</p>
<p>每个方法执行的同时都会创建一个栈帧，用于存储<strong>局部变量表（方法内的参数）、操作数栈、动态链接、方法出口等信息</strong>，每一个方法从调用直至执行完毕的过程，就对应着一个栈帧在虚拟机中入栈到出栈的过程。栈的大小和具体JVM的实现有关，通常在256K~756K之间,与等于1Mb左右。</p>
<p><strong>SOF(StackOverflowError)</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mxx.jvm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Stack</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">m1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        m1();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        m1();</span><br><span class="line">        <span class="comment">// Exception in thread "main" java.lang.StackOverflowError</span></span><br><span class="line">        <span class="comment">// 使用递归把java栈压爆</span></span><br><span class="line">        <span class="comment">// 原理：方法的加载，深度调用使栈被压爆。</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>这不是异常，属于错误</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java.lang.Object </span><br><span class="line">	java.lang.Throwable </span><br><span class="line">		java.lang.Error </span><br><span class="line">			java.lang.VirtualMachineError </span><br><span class="line">				java.lang.StackOverflowError</span><br></pre></td></tr></table></figure></div>



<h2 id="栈-堆-方法区的交互关系"><a href="#栈-堆-方法区的交互关系" class="headerlink" title="栈+堆+方法区的交互关系"></a>栈+堆+方法区的交互关系</h2><a href="/2020/02/15/20200215102406916/image-20200215152824741.png" data-fancybox="group" data-caption="image-20200215152824741" class="fancybox"><img alt="image-20200215152824741" style="zoom:80%;" title="image-20200215152824741" data-src="/2020/02/15/20200215102406916/image-20200215152824741.png" class="lazyload"></a>

<p>User user = new User()</p>
<p>reference: 就是等号左边的引用user<br>referrence指向右边的实例对象，这个对象存在堆里。<br>实例对象里有指针，指向对象类型数据，这类型数据存在方法区里。</p>
<p>HotSpot是使用指针的方式来访问对象：<br>Java堆中会存放访问类元数据的地址（类结构信息），<br>reference存储的就直接是对象的地址</p>
<h1 id="堆体系结构"><a href="#堆体系结构" class="headerlink" title="堆体系结构"></a>堆体系结构</h1><h2 id="堆结构简介"><a href="#堆结构简介" class="headerlink" title="堆结构简介"></a>堆结构简介</h2><p>一个JVM实例只存在一个堆内存，堆内存的大小是可以调节的。类加载器读取了类文件后，需要把类、方法、常变量放到堆内存中，保存所有引用类型的真实信息，以方便执行器执行，堆内存分为三部分</p>
<a href="/2020/02/15/20200215102406916/image-20200215161821093.png" data-fancybox="group" data-caption="image-20200215161821093" class="fancybox"><img alt="image-20200215161821093" style="zoom:80%;" title="image-20200215161821093" data-src="/2020/02/15/20200215102406916/image-20200215161821093.png" class="lazyload"></a>

<p>一个JVM实例只存在一个堆内存，堆内存的大小是可以调节的。类加载器读取了类文件后，需要把类、方法、常变量放到堆内存中，保存所有引用类型的真实信息，以方便执行器执行。</p>
<p>堆内存逻辑上分为三部分：新生+养老+永久<br>物理上：新生+养老</p>
<h2 id="字符串常量池"><a href="#字符串常量池" class="headerlink" title="字符串常量池"></a>字符串常量池</h2><p>字符串虽然是引用类型，但传进方法是无法改变方法外部的值的。为什么？<br>因为存在字符串常量池</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">changeStr</span><span class="params">(String str)</span></span>&#123;</span><br><span class="line">        str = <span class="string">"bbb"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str = <span class="string">"aaa"</span>;</span><br><span class="line">        changeStr(str);</span><br><span class="line">        System.out.println(str);    <span class="comment">// aaa</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>原理：</p>
<a href="/2020/02/15/20200215102406916/image-20200215171959791.png" data-fancybox="group" data-caption="image-20200215171959791" class="fancybox"><img alt="image-20200215171959791" style="zoom:80%;" title="image-20200215171959791" data-src="/2020/02/15/20200215102406916/image-20200215171959791.png" class="lazyload"></a>

<h2 id="堆的new对象流程"><a href="#堆的new对象流程" class="headerlink" title="堆的new对象流程"></a>堆的new对象流程</h2><ol>
<li><p>new Book()是new在新生代伊甸园区</p>
</li>
<li><p>当伊甸园区用完，程序又需要创建对象，就会触发GC（或者叫YGC，Young GC）</p>
</li>
<li><p>YGC将伊甸园区中的不再被其他对象所引用的对象进行销毁</p>
</li>
<li><p>然后将伊甸园中的剩余对象移动到幸存 0区（S0区）</p>
</li>
<li><p>如果一直往伊甸园new对象，就造成幸存 0区也满了，再对该区进行垃圾回收，然后移动到 1 区。</p>
</li>
<li><p>那如果1 区也满了呢？再移动到养老区。</p>
</li>
<li><p>若养老区也满了，那么这个时候将产生MajorGC（FullGC，FGC），进行养老区的内存清理。</p>
</li>
<li><p>若养老区执行了Full GC之后发现依然无法进行对象的保存，就会产生OOM异常“OutOfMemoryError”。</p>
<p>如果出现java.lang.OutOfMemoryError: Java heap space异常，说明Java虚拟机的堆内存不够。原因有二：</p>
<p>（1）Java虚拟机的堆内存设置不够，可以通过参数-Xms、-Xmx来调整。</p>
<p>（2）代码中创建了大量大对象，并且长时间不能被垃圾收集器收集（存在被引用）。</p>
</li>
</ol>
<h1 id="堆参数调优"><a href="#堆参数调优" class="headerlink" title="堆参数调优"></a>堆参数调优</h1><h1 id="面试"><a href="#面试" class="headerlink" title="面试"></a>面试</h1><p>面试高频考点在java栈和堆。其他几个结构需要浅层理解功能作用。</p>
<p>难记：*</p>
<ol>
<li>什么是类加载器</li>
<li>装载器类型？</li>
<li>双亲委派机制？沙箱安全机制？</li>
<li>native是什么东西？为什么有申明无实现？</li>
<li>pc寄存器是什么？</li>
<li>方法区</li>
<li>栈是干嘛的？</li>
<li>*函数的栈内存保存了哪些东西？</li>
<li>*栈帧中主要保存什么数据？</li>
<li>栈运行原理？</li>
<li>StackOverflowError是怎么发生的？</li>
<li>栈+堆+方法区的交互关系</li>
</ol>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Machine</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://machine4869.gitee.io/2020/02/15/20200215102406916/">https://machine4869.gitee.io/2020/02/15/20200215102406916/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://machine4869.gitee.io">哑舍</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AF%95/">Java面试笔试    </a><a class="post-meta__tags" href="/tags/JVM/">JVM    </a></div><div class="post_share"><div class="social-share" data-image="/img/default_p11.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.png" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付宝"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/02/21/20200221192831555/"><img class="prev_cover lazyload" data-src="/img/default_p12.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>Java面试之JUC</span></div></a></div><div class="next-post pull_right"><a href="/2020/02/13/20200213103244757/"><img class="next_cover lazyload" data-src="/img/default_p7.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>SparkCore</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/02/21/20200221192831555/" title="Java面试之JUC"><img class="relatedPosts_cover lazyload"data-src="/img/default_p12.jpeg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-21</div><div class="relatedPosts_title">Java面试之JUC</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = true == true ? true : false;
var verify = false == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'yPVvDIaWlODDhs0bbECwLIIp-gzGzoHsz',
  appKey:'VyOIa40LxnjURzW1HUCiwTpV',
  placeholder:'记得留下你的昵称及邮箱，以便收到答复~',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10',
  lang:'zh-cn',
  recordIP: true
});</script></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2020 By Machine</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://machine4869.gitee.io/">blog</a>!</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">简</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script id="canvas_nest" color="215,215,215" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/canvas-nest.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>